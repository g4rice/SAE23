<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Instant Weather</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- ========== FEUILLE DE STYLE PRINCIPALE ========== -->
  <link rel="stylesheet" href="styles.css" />

  <!-- ========== LEAFLET CSS (si vous lâ€™utilisez) ========== -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />

  <!-- ========== CHART.JS (si vous lâ€™utilisez) ========== -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div id="app-container">
    <!-- =======================================================
         HEADER : logo centrÃ© + bouton sombre/clair en haut Ã  droite
         ======================================================= -->
    <header>
      <!-- VÃ©rifiez bien que ce fichier existe : img/logo.png -->
      <img src="img/logo.png" alt="Instant Weather" class="logo" />

      <!-- BOUTON ğŸŒ™/â˜€ï¸ POUR BASCULER LE THÃˆME -->
      <button id="toggle-theme" class="btn-icon" aria-label="Basculer thÃ¨me sombre / clair">
        ğŸŒ™
      </button>
    </header>

    <!-- ========== SECTION RECHERCHE (FORMULAIRE) ========== -->
    <section id="search-section">
      <form id="weatherForm">
        <!-- Champ Â« Ville Â» -->
        <div class="form-group">
          <label for="ville">Recherche&nbsp;:</label>
          <input
            type="text"
            id="ville"
            placeholder="Ex : Marseille ou 13000"
            aria-required="true"
          />
        </div>

        <!-- Champ Â« Nombre de jours Â» -->
        <div class="form-group">
          <label for="jours">Nombre de jours&nbsp;:</label>
          <div class="slider-container">
            <input
              type="range"
              id="jours"
              min="1"
              max="7"
              value="1"
              oninput="this.nextElementSibling.innerText = this.value + (this.value > 1 ? ' jours' : ' jour')"
            />
            <span class="slider-value">1 jour</span>
          </div>
        </div>

        <!-- Fieldset Â« Informations supplÃ©mentaires Â» -->
        <fieldset class="infos-sup">
          <legend>Informations supplÃ©mentaires&nbsp;:</legend>
          <label>
            <input type="checkbox" name="infos" value="latitude" />
            Latitude
          </label>
          <label>
            <input type="checkbox" name="infos" value="longitude" />
            Longitude
          </label>
          <label>
            <input type="checkbox" name="infos" value="pluie" />
            Cumul de pluie (mm)
          </label>
          <label>
            <input type="checkbox" name="infos" value="vent" />
            Vent moyen (km/h)
          </label>
          <label>
            <input type="checkbox" name="infos" value="direction" />
            Direction du vent (Â°)
          </label>
        </fieldset>

        <!-- Boutons dâ€™action -->
        <div class="buttons-container">
          <button type="submit" class="btn-primary">Afficher la mÃ©tÃ©o</button>
          <button type="button" id="toggle-units" class="btn-secondary">Passer en Â°F</button>
          <button type="button" id="geo-btn" class="btn-secondary">ğŸ“ Utiliser ma position</button>
        </div>
      </form>
    </section>

    <!-- ========== SECTION CARTE LEAFLET ========== -->
    <section id="map-section">
      <h2 id="commune-name"></h2>

      <!-- Conteneur pour afficher latitude/longitude si sÃ©lectionnÃ© -->
      <div id="coords"></div>

      <!-- Loader lors du fetch mÃ©tÃ©o -->
      <div id="loader" class="hidden">
        <p>Chargement en coursâ€¦</p>
      </div>

      <!-- Conteneur carte Leaflet -->
      <div id="map-container">
        <div id="mapid" class="hidden" role="application" aria-label="Carte de localisation"></div>
      </div>
    </section>

    <!-- ========== SECTION PRÃ‰VISIONS MÃ‰TÃ‰O ========== -->
    <section id="forecast-section">
      <div id="forecast-container">
        <!-- Les forecast-cards seront injectÃ©es ici par recupinfometeo.js -->
      </div>
    </section>

    <!-- ========== SECTION GRAPHIQUE (Chart.js) ========== -->
    <section id="chart-section">
      <h3 class="chart-title">Graphique des tempÃ©ratures pour plusieurs jours</h3>
      <canvas id="tempChart"></canvas>
    </section>

    <!-- ========== FOOTER ========== -->
    <footer>
      Â© 2025 Instant Weather â€“ Tous droits rÃ©servÃ©s
    </footer>
  </div> <!-- /#app-container -->

  <!-- ========== SCRIPTS ========== -->
  <!-- 1) Leaflet JS (si vous utilisez une carte) -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- 2) Vos scripts mÃ©tier -->
  <script src="recupinfometeo.js"></script>
  <script src="recupinfoville.js"></script>

  <!-- 3) Script bascule sombre/clair (toggle-theme) -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      console.log('âœ… DOMContentLoaded dÃ©clenchÃ©');
      const btnToggle = document.getElementById('toggle-theme');
      console.log('ğŸ” Bouton bascule trouvÃ© :', btnToggle);

      if (!btnToggle) {
        console.error('âŒ Bouton toggle-theme introuvable');
        return;
      }

      //  Au chargement, on regarde dans localStorage si lâ€™utilisateur avait demandÃ© le "dark"
      if (localStorage.getItem('theme') === 'dark') {
        document.body.classList.add('dark-mode');
        btnToggle.textContent = 'â˜€ï¸';
        console.log('âš«ï¸ Chargement en MODE SOMBRE, icÃ´ne â˜€ï¸');
      } else {
        btnToggle.textContent = 'ğŸŒ™';
        console.log('ğŸ”† Chargement en MODE CLAIR, icÃ´ne ğŸŒ™');
      }

      btnToggle.addEventListener('click', () => {
        console.log('ğŸ‘‰ Bouton ğŸŒ™/â˜€ï¸ cliquÃ©');
        document.body.classList.toggle('dark-mode');
        const isDark = document.body.classList.contains('dark-mode');
        btnToggle.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        console.log(isDark ? 'âš«ï¸ Passage en SOMBRE' : 'ğŸ”† Passage en CLAIR');
      });
    });
  </script>
</body>
</html>
